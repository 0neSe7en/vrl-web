- id: 0
  title: Syslog
  event:
    message: <102>1 2020-12-22T15:22:31.111Z vector-user.biz su 2666 ID389 - Something went wrong
  program: |-
    # Parse as JSON or error if malformed
    parsed, err = parse_syslog(.message)
    if err != null {
      log(err, level: "error")
    }

    # Set the event to the parsed JSON value
    . = parsed

    # Remove some fields
    del(.msgid)
    del(.appname)

    # Reformat the timestamp
    ts, err = parse_timestamp(.timestamp, format: "%s")
    if err != null {
      log(err, level: "error")
    }

    .timestamp = to_unix_timestamp(ts)
- id: 1
  title: Key/value (logfmt) logs
  event:
    message: |-
      @timestamp="Sun Jan 10 16:47:39 EST 2021" level=info msg="Stopping all fetchers" tag#production=stopping_fetchers id=ConsumerFetcherManager-1382721708341 module=kafka.consumer.ConsumerFetcherManager
  program: |-
    . = parse_key_value!(.message)
- id: 2
  title: Modify metric tags
  event:
    counter:
      value: 102
    kind: incremental
    name: user_login_total
    tags:
      email: vic@vector.dev
      host: my.host.com
      instance_id: abcd1234
  program: |-
    .tags.environment = get_env_var!("ENV")
    .tags.hostname = del(.tags.host)
    del(.tags.email)
- id: 3
  title: This should error
  event:
    foo: "bar"
  program: |-
    uh oh spaghettios